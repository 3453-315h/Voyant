{"version":3,"file":"spyral.js","sources":["../../../../../../../voyantjs/src/loader.js","../../../../../../../voyantjs/src/corpus.js","../../../../../../../voyantjs/src/chart.js","../../../../../../../voyantjs/src/table.js","../src/notebook.js","../src/util.js","../src/metadata.js"],"sourcesContent":["export default class Loader {\n\tstatic baseUrl;\n\tstatic setBaseUrl(baseUrl) {\n\t\tthis.baseUrl = baseUrl;\n\t}\n\n\tstatic trombone(config = {}, params) {\n\t\tlet url = new URL(config.trombone ? config.trombone : this.baseUrl + \"trombone\");\n\t\tlet all = { ...config, ...params };\n\t\tfor (var key in all) {\n\t\t\tif (all[key] === undefined) { delete all[key] }\n\t\t}\n\t\tlet searchParams = Object.keys(all).map(key => encodeURIComponent(key) + '=' + encodeURIComponent(all[key])).join(\"&\")\n\t\tlet opt = {};\n\t\tif (searchParams.length < 800 || (\"method\" in all && all[\"method\"] == \"GET\")) {\n\t\t\tfor (var key in all) { url.searchParams.set(key, all[key]); }\n\t\t} else {\n\t\t\topt = {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },\n\t\t\t\tbody: searchParams\n\t\t\t}\n\t\t}\n\t\treturn fetch(url, opt).then(response => {\n\t\t\tif (response.ok) {\n\t\t\t\treturn response.json()\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn response.text().then(text => {\n\t\t\t\t\tif (Voyant && Voyant.util && Voyant.util.DetailedError) {\n\t\t\t\t\t\tnew Voyant.util.DetailedError({\n\t\t\t\t\t\t\tmsg: \"\",\n\t\t\t\t\t\t\terror: text.split(/(\\r\\n|\\r|\\n)/).shift(),\n\t\t\t\t\t\t\tdetails: text\n\t\t\t\t\t\t}).showMsg();\n\t\t\t\t\t} else {\n\t\t\t\t\t\talert(text.split(/(\\r\\n|\\r|\\n)/).shift())\n\t\t\t\t\t\tif (window.console) { console.error(text) }\n\t\t\t\t\t}\n\t\t\t\t\tthrow Error(text);\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\n\n\t}\n\n\tstatic load(urlToFetch, config) {\n\t\tlet url = new URL(config && config.trombone ? config.trombone : this.baseUrl + \"trombone\");\n\t\turl.searchParams.set(\"fetchData\", urlToFetch);\n\t\treturn fetch(url).then(response => {\n\t\t\tif (response.ok) {\n\t\t\t\treturn response;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn response.text().then(text => {\n\t\t\t\t\tif (Voyant && Voyant.util && Voyant.util.DetailedError) {\n\t\t\t\t\t\tnew Voyant.util.DetailedError({\n\t\t\t\t\t\t\terror: text.split(/(\\r\\n|\\r|\\n)/).shift(),\n\t\t\t\t\t\t\tdetails: text\n\t\t\t\t\t\t}).showMsg();\n\t\t\t\t\t} else {\n\t\t\t\t\t\talert(text.split(/(\\r\\n|\\r|\\n)/).shift())\n\t\t\t\t\t\tif (window.console) { console.error(text) }\n\t\t\t\t\t}\n\t\t\t\t\tthrow Error(text);\n\t\t\t\t});\n\t\t\t}\n\t\t}).catch(err => { throw err })\n\t}\n\n\tstatic html(url) {\n\t\treturn this.text(url).then(text => new DOMParser().parseFromString(text, 'text/html'));\n\t}\n\tstatic xml(url) {\n\t\treturn this.text(url).then(text => new DOMParser().parseFromString(text, 'text/xml'));\n\t}\n\tstatic json(url) {\n\t\treturn this.load(url).then(response => response.json());\n\t}\n\tstatic text(url) {\n\t\treturn this.load(url).then(response => response.text());\n\t}\n}\n","import Loader from './loader';\n\nexport function load(config) {\n\treturn Corpus.load(config);\n}\n\nexport function create(config) {\n\treturn Corpus.load(config);\n}\n\nexport function id(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.id(api || config));\n}\n\nexport function metadata(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.metadata(api || config));\n}\n\nexport function summary(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.summary(api || config));\n}\n\nexport function titles(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.titles(api || config));\n}\n\nexport function text(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.text(api || config));\t\n}\n\nexport function texts(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.texts(api || config));\t\n}\n\nexport function terms(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.terms(api || config));\n}\n\nexport function tokens(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.tokens(api || config));\n}\n\nexport function words(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.words(api || config));\n}\n\nexport function contexts(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.contexts(api || config));\n}\n\nexport function collocates(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.collocates(api || config));\n}\n\nexport function phrases(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.phrases(api || config));\n}\n\nexport function correlations(config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.correlations(api || config));\n}\n\nexport function tool(target, tool, config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.tool(target, tool, api || config));\n}\n\nexport function htmltool(html, tool, config, api) {\n\treturn Corpus.load(config).then(corpus => corpus.htmltool(html, tool, api || config));\n}\n\nexport function setBaseUrl(baseUrl) {\n\tLoader.setBaseUrl(baseUrl);\n}\n\nfunction isDocumentsMode(config) {\n\treturn config && ((config.mode && config.mode === \"documents\") || config.documents);\n}\n\nexport class Corpus {\n\tconstructor(id) {\n\t\tthis.corpusid = id;\n\t}\n\n\tstatic Loader = Loader;\n\n\tid() {\n\t\tlet me = this\n\t\treturn new Promise(resolve => resolve(me.corpusid));\n\t}\n\tmetadata(config, params) {\n\t\treturn Loader.trombone(config, {\n\t\t\ttool: isDocumentsMode(config) ? \"corpus.DocumentsMetadata\" : \"corpus.CorpusMetadata\",\n\t\t\tcorpus: this.corpusid\n\t\t})\n\t\t.then(data => isDocumentsMode(config) ? data.documentsMetadata.documents : data.corpus.metadata)\n\t}\n\t\n\tsummary(config) {\n\t\treturn this.metadata().then(data => {\n\t\t\t// TODO: make this a template\n\t\t\treturn `This corpus (${data.alias ? data.alias : data.id}) has ${data.documentsCount.toLocaleString()} documents with ${data.lexicalTokensCount.toLocaleString()} total words and ${data.lexicalTypesCount.toLocaleString()} unique word forms.`\n\t\t})\n\t}\n\t\n\ttitles(config) {\n\t\treturn Loader.trombone(config, {\n\t\t\ttool: \"corpus.DocumentsMetadata\",\n\t\t\tcorpus: this.corpusid\n\t\t})\n\t\t.then(data => data.documentsMetadata.documents.map(doc => doc.title))\n\t}\n\t\n\ttext(config) {\n\t\treturn this.texts(config).then(data => data.join(\"\\n\"))\n\t}\n\t\n\ttexts(config) {\n\t\treturn Loader.trombone(config, {\n\t\t\ttool: \"corpus.CorpusTexts\",\n\t\t\tcorpus: this.corpusid\n\t\t}).then(data => data.texts.texts)\n\t}\n\t\n\tterms(config) {\n\t\treturn Loader.trombone(config, {\n\t\t\ttool: isDocumentsMode(config) ? \"corpus.DocumentTerms\" : \"corpus.CorpusTerms\",\n\t\t\tcorpus: this.corpusid\n\t\t}).then(data => isDocumentsMode(config) ? data.documentTerms.terms : data.corpusTerms.terms)\n\t}\n\t\n\ttokens(config) {\n\t\treturn Loader.trombone(config, {\n\t\t\ttool: \"corpus.DocumentTokens\",\n\t\t\tcorpus: this.corpusid\n\t\t}).then(data => data.documentTokens.tokens)\n\t}\n\n\twords(config = {}) {\n\t\t// by default DocumentTokens limits to 50 which probably isn't expected\n\t\tif (!(\"limit\" in config)) {config.limit=0;}\n\t\treturn Loader.trombone(config, {\n\t\t\ttool: \"corpus.DocumentTokens\",\n\t\t\tnoOthers: true,\n\t\t\tcorpus: this.corpusid\n\t\t}).then(data => data.documentTokens.tokens)\n\t}\n\t\n\tcontexts(config) {\n\t\tif ((!config || !config.query) && console) {console.warn(\"No query provided for contexts request.\")}\n\t\treturn Loader.trombone(config, {\n\t\t\ttool: \"corpus.DocumentContexts\",\n\t\t\tcorpus: this.corpusid\n\t\t}).then(data => data.documentContexts.contexts)\n\t}\n\t\n\tcollocates(config) {\n\t\tif ((!config || !config.query) && console) {console.warn(\"No query provided for collocates request.\")}\n\t\treturn Loader.trombone(config, {\n\t\t\ttool: \"corpus.CorpusCollocates\",\n\t\t\tcorpus: this.corpusid\n\t\t}).then(data => data.corpusCollocates.collocates)\n\t}\n\n\tphrases(config) {\n\t\treturn Loader.trombone(config, {\n\t\t\ttool: isDocumentsMode(config) ? \"corpus.DocumentNgrams\" : \"corpus.CorpusNgrams\",\n\t\t\tcorpus: this.corpusid\n\t\t}).then(data => isDocumentsMode(config) ? data.documentNgrams.ngrams : data.corpusNgrams.ngrams)\n\t}\n\t\n\tcorrelations(config) {\n\t\tif ((!config || !config.query) && console) {\n\t\t\tconsole.warn(\"No query provided for correlations request.\")\n\t\t\tif (!isDocumentsMode(config)) {\n\t\t\t\tthrow new Error(\"Unable to run correlations for a corpus without a query.\")\n\t\t\t}\n\t\t}\n\t\treturn Loader.trombone(config, {\n\t\t\ttool: isDocumentsMode(config) ? \"corpus.DocumentTermCorrelations\" : \"corpus.CorpusTermCorrelations\",\n\t\t\tcorpus: this.corpusid\n\t\t}).then(data => data.termCorrelations.correlations)\n\t}\n\t\n\ttool(target, tool, config = {}) {\n\t\tlet me = this;\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tlet out='<iframe ';\n\n\t\t\t// construct attributes of iframe\n\t\t\tlet defaultAttributes = {\n\t\t\t\twidth: undefined,\n\t\t\t\theight: undefined,\n\t\t\t\tstyle: \"width: 90%; height: 400px\"\n\t\t\t}\n\t\t\tfor (let attr in defaultAttributes) {\n\t\t\t\tvar val = config[attr] || defaultAttributes[attr];\n\t\t\t\tif (val) {\n\t\t\t\t\tout+=' '+attr+'=\"'+val+'\"';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// construct src URL\n\t\t\tvar url = new URL((config && config.voyantUrl ? config.voyantUrl : Loader.baseUrl) + \"tool/\"+tool+\"/\");\n\t\t\turl.searchParams.append(\"corpus\", me.corpusid);\n\t\t\t\n\t\t\t// add API values from config (some may be ignored)\n\t\t\tObject.keys(config || {}).forEach(key => {\n\t\t\t\tif (key !==\"input\" && !(key in defaultAttributes)) {\n\t\t\t\t\turl.searchParams.append(key, config[key])\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tout+=' src=\"'+url+'\"></iframe>'\n\t\t\t\n\t\t\tif (typeof target === \"function\") {\n\t\t\t\tresolve(target(out));\n\t\t\t} else {\n\t\t\t\tif (typeof target === \"string\") {\n\t\t\t\t\ttarget = document.querySelector(target);\n\t\t\t\t}\n\t\t\t\tif (typeof target === \"object\" && \"innerHTML\" in target) {\n\t\t\t\t\ttarget.innerHTML = out;\n\t\t\t\t\tresolve(out);\n\t\t\t\t}\n\t\t\t}\n\t\t\tresolve(out); // just return the tag\n\t\t})\n\t}\n\n\thtmltool(html, tool, config) {\n\t\treturn new Promise((resolve,reject) => {\n\t\t\tthis.tool(undefined, tool, config).then(out => resolve(html`${out}`));\n\t\t});\n\t}\n\n\ttoString() {\n\t\treturn this.summary()\n\t}\n\t\n\tstatic load(config) {\n\t\tconst promise = new Promise(function(resolve, reject) {\n\t\t\tif (config instanceof Corpus) {\n\t\t\t\tresolve(config);\n\t\t\t} else if (typeof config === \"string\" && config.length>0 && /\\W/.test(config)===false) {\n\t\t\t\tresolve(new Corpus(config)); \n\t\t\t} else if (typeof config === \"object\" && config.corpus) {\n\t\t\t\tresolve(new Corpus(config.corpus))\n\t\t\t} else {\n\t\t\t\tif (typeof config === \"string\") {config = {input: config}}\n\t\t\t\tif (config && config.input) {\n\t\t\t\t\tLoader.trombone(config, {tool: \"corpus.CorpusMetadata\"})\n\t\t\t\t\t.then(data => resolve(new Corpus(data.corpus.metadata.id)))\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t[\"id\",\"metadata\",\"summary\",\"titles\",\"text\",\"texts\",\"terms\",\"tokens\",\"words\",\"contexts\",\"collocates\",\"phrases\",\"correlations\",\"tool\"].forEach(name => {\n\t\t\tpromise[name] = function() {\n\t\t\t\tvar args = arguments\n\t\t\t\treturn promise.then(corpus => {return corpus[name].apply(corpus, args)})\n\t\t\t}\n\t\t})\n\t\tpromise.assign = function(name) {\n\t\t\tthis.then(corpus => {window[name] = corpus; return corpus})\n\t\t}\n\n\t\treturn promise;\n\t}\n}\n","import * as Highcharts from 'highcharts';\n\nexport function chart(target, config) {\n\t\n\t// convert title and suppress if not provided\n\tif (\"title\" in config) {\n\t\tif (typeof config.title == \"string\") {\n\t\t\tconfig.title = {text: config.title};\n\t\t}\n\t} else {\n\t\tconfig.title = false;\n\t}\n\t\n\t// convert subtitle and convert if not provided\n\tif (\"subtitle\" in config) {\n\t\tif (typeof config.subtitle == \"string\") {\n\t\t\tconfig.subtitle = {text: config.subtitle};\n\t\t}\n\t} else {\n\t\tconfig.subtitle = false;\n\t}\n\t\n\t// convert credits\n\tif (!(\"credits\" in config)) {\n\t\tconfig.credits = false;\n\t}\n\t\n\t// suppress xAxis title unless provided\n\tif (!(\"xAxis\" in config)) {config.xAxis = {}}\n\tif (!(\"title\" in config.xAxis)) {\n\t\t//config.xAxis.title = false;\n\t}\n\n\t// suppress xAxis title unless provided\n\tif (!(\"yAxis\" in config)) {config.yAxis = {}}\n\tif (!(\"title\" in config.yAxis)) {\n\t\tconfig.yAxis.title = false;\n\t}\n\t\n\treturn Highcharts.chart(target, config);\n}\n\nexport function setDefaultChartType(config, type) {\n\tif (\"type\" in config) {\n\t\tconfig.chart.type = config.type;\n\t\tdelete config.type;\n\t\treturn\n\t}\n\t// TODO: check plot options and series?\n\tif (\"chart\" in config && \"type\" in config.chart) {return} // already set\n\tconfig.chart.type = type;\n\treturn;\n}\n\n\nclass Chart {\n    constructor(target, data) {\n\t    this.target = target;\n\t    this.data = data;\n    }\n\tchart(target, config) {\n\t\tHighcharts.chart(target, config);\n\t}\n    bar(config) {\n    }\n    line(config) {\n    }\n    scatter(config) {\n    }\n}","import * as Chart from \"./chart.js\";\n\nexport class Table {\n\n\tconstructor(data, config, ...other) {\n\n\t\tthis._rows = [];\n\t\tthis._headers = {};\n\t\tthis._rowKeyColumnIndex = 0;\n\t\t\n\t\t// we have a configuration object followed by values: create({headers: []}, 1,2,3) …\n\t\tif (data && typeof data == \"object\" && (typeof config == \"string\" || typeof config == \"number\" || Array.isArray(config))) {\n\t\t\tdata.rows = [config].concat(other).filter(v => v!==undefined)\n\t\t\tconfig = undefined;\n\t\t}\n\t\t\n\t\t// we have a simple variable set of arguments: create(1,2,3) …\n\t\tif (arguments.length>0 && Array.from(arguments).every(a => a!==undefined && !Array.isArray(a) && typeof a != \"object\")) {\n\t\t\tdata = [data,config].concat(other).filter(v => v!==undefined)\n\t\t\tconfig = undefined;\n\t\t}\n\t\t\n\t\t// could be CSV or TSV\n\t\tif (Array.isArray(data) && data.length==1 && typeof data[0] == \"string\"  && (data[0].indexOf(\",\")>-1 || data[0].indexOf(\"\\t\")>-1)) {\n\t\t\tdata = data[0];\n\t\t}\n\n\t\t// first check if we have a string that might be delimited data\n\t\tif (data && (typeof data == \"string\" || typeof data ==\"number\")) {\n\t\t\tif (typeof data == \"number\") {data = String(data)} // convert to string for split\n\t\t\tlet rows = [];\n\t\t\tlet format = config && \"format\" in config ? config.format : undefined;\n\t\t\tdata.split(/(\\r\\n|[\\n\\v\\f\\r\\x85\\u2028\\u2029])+/g).forEach((line,i) => {\n\t\t\t\tif (line.trim().length>0) {\n\t\t\t\t\tlet values;\n\t\t\t\t\tif ((format && format==\"tsv\") || line.indexOf(\"\\t\")>-1) {\n\t\t\t\t\t\tvalues = line.split(/\\t/);\n\t\t\t\t\t} else if ((format && format==\"csv\") || line.indexOf(\",\")>-1) {\n\t\t\t\t\t\tvalues = parseCsvLine(line)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues = [line]\n\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\t// if we can't find any config information for headers then we try to guess\n\t\t\t\t\t// if the first line doesn't have any numbers - this heuristic may be questionable\n\t\t\t\t\tif (i==0 && values.every(v => isNaN(v)) && \n\t\t\t\t\t\t((typeof config != \"object\") || (typeof config == \"object\" && !(\"hasHeaders\" in config) && !(\"headers\" in config)))) {\n\t\t\t\t\t\tthis.setHeaders(values);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trows.push(values.map(v => isNaN(v) ? v : Number(v)))\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\tdata = rows;\n\t\t}\n\t\t\n\t\tif (data && Array.isArray(data)) {\n\t\t\tif (config) {\n\t\t\t\tif (Array.isArray(config)) {\n\t\t\t\t\tthis.setHeaders(config);\n\t\t\t\t} else if (typeof config == \"object\") {\n\t\t\t\t\tif (\"headers\" in config) {\n\t\t\t\t\t\tthis.setHeaders(config.headers)\n\t\t\t\t\t} else if (\"hasHeaders\" in config && config.hasHeaders) {\n\t\t\t\t\t\tthis.setHeaders(data.shift())\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (config && \"count\" in config && config.count) {\n\t\t\t\tlet freqs = Table.counts(data);\n\t\t\t\tif (config.count==\"vertical\" || (\"orientation\" in config && config.orientation==\"vertical\")) {\n\t\t\t\t\tfor (let item in freqs) {\n\t\t\t\t\t\tthis.addRow(item, freqs[item])\n\t\t\t\t\t}\n\t\t\t\t\tthis.rowSort((a,b) => Table.cmp(b[1],a[1]))\n\t\t\t\t} else {\n\t\t\t\t\tthis._headers = []; // reset and use the terms as headers\n\t\t\t\t\tthis.addRow(freqs)\n\t\t\t\t\tthis.columnSort((a,b) => Table.cmp(this.cell(0,b),this.cell(0,a)))\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.addRows(data);\n\t\t\t}\n\t\t} else if (data && typeof data == \"object\") {\n\t\t\tif (\"headers\" in data && Array.isArray(data.headers)) {\n\t\t\t\tthis.setHeaders(data.headers);\n\t\t\t} else if (\"hasHeaders\" in data && \"rows\" in data) {\n\t\t\t\tthis.setHeaders(data.rows.shift())\n\t\t\t}\n\t\t\tif (\"rows\" in data && Array.isArray(data.rows)) {\n\t\t\t\tthis.addRows(data.rows)\n\t\t\t}\n\t\t\tif (\"rowKeyColumn\" in data) {\n\t\t\t\tif (typeof data.rowKeyColumn == \"number\") {\n\t\t\t\t\tif (data.rowKeyColumn < this.columns()) {\n\t\t\t\t\t\tthis._rowKeyColumnIndex = data.rowKeyColumn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(\"The rowKeyColumn value is higher than the number headers designated: \"+data.rowKeyColum);\n\t\t\t\t\t}\n\t\t\t\t} else if (typeof data.rowKeyColumn == \"string\") {\n\t\t\t\t\tif (data.rowKeyColumn in this._headers) {\n\t\t\t\t\t\tthis._rowKeyColumnIndex = this._headers[data.rowKeyColumn];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(\"Unable to find column designated by rowKeyColumn: \"+data.rowKeyColumn);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tsetHeaders(data) {\n\t\tif (data && Array.isArray(data)) {\n\t\t\tdata.forEach(h => this.addColumn(h), this);\n\t\t} else if (typeof data == \"object\") {\n\t\t\tif (this.columns()==0 || Object.keys(data).length==this.columns()) {\n\t\t\t\tthis._headers = data;\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"The number of columns don't match: \");\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new Error(\"Unrecognized argument for headers, it should be an array or an object.\"+data)\n\t\t}\n\t\treturn this;\n\t}\n\t\n\taddRows(data) {\n\t\tdata.forEach(row => this.addRow(row), this);\n\t\treturn this;\n\t}\n\t\n\taddRow(data, ...other) {\n\t\t\n\t\t// we have multiple arguments, so call again as an array\n\t\tif (other.length>0) {\n\t\t\treturn this.addRow([data].concat(other))\n\t\t}\n\n\t\tthis.setRow(this.rows(), data, true);\n\t\treturn this;\n\t}\n\t\n\tsetRow(ind, data, create) {\n\n\t\tlet rowIndex = this.getRowIndex(ind, create);\n\t\tif (rowIndex>=this.rows() && !create) {\n\t\t\tthrow new Error(\"Attempt to set row values for a row that does note exist: \"+ind+\". Maybe use addRow() instead?\");\n\t\t}\n\t\t\n\t\t// we have a simple array, so we'll just push to the rows\n\t\tif (data && Array.isArray(data)) {\n\t\t\tif (data.length>this.columns()) {\n\t\t\t\tif (create) {\n\t\t\t\t\tfor (let i = this.columns(); i<data.length; i++) {\n\t\t\t\t\t\tthis.addColumn();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(\"The row that you've created contains more columns than the current table. Maybe use addColunm() first?\")\n\t\t\t\t}\n\t\t\t}\n\t\t\tdata.forEach((d,i) => this.setCell(rowIndex, i, d), this);\n\t\t}\n\t\t\n\t\t// we have an object so we'll use the headers\n\t\telse if (typeof data == \"object\") {\n\t\t\tfor (let column in data) {\n\t\t\t\tif (!this.hasColumn(column)) {\n\t\t\t\t}\n\t\t\t\tthis.setCell(rowIndex, column, data[column]);\n\t\t\t}\n\t\t}\n\t\t\n\t\telse if (this.columns()<2 && create) { // hopefully some scalar value\n\t\t\tif (this.columns()==0) {\n\t\t\t\tthis.addColumn(); // create first column if it doesn't exist\n\t\t\t}\n\t\t\tthis.setCell(rowIndex,0,data);\n\t\t} else {\n\t\t\tthrow new Error(\"setRow() expects an array or an object, maybe setCell()?\")\n\t\t}\n\t\t\n\t\treturn this;\n\n\t}\n\t\n\tsetColumn(ind, data, create) {\n\n\t\tlet columnIndex = this.getColumnIndex(ind, create);\n\t\tif (columnIndex>=this.columns() && !create) {\n\t\t\tthrow new Error(\"Attempt to set column values for a column that does note exist: \"+ind+\". Maybe use addColumn() instead?\");\n\t\t}\n\t\t\n\t\t// we have a simple array, so we'll just push to the rows\n\t\tif (data && Array.isArray(data)) {\n\t\t\tdata.forEach((d,i) => this.setCell(i, columnIndex, d, create), this);\n\t\t}\n\t\t\n\t\t// we have an object so we'll use the headers\n\t\telse if (typeof data == \"object\") {\n\t\t\tfor (let row in data) {\n\t\t\t\tthis.setCell(row, columnIndex, data[column], create);\n\t\t\t}\n\t\t}\n\t\t\n\t\t// hope we have a scalar value to assign to the first row\n\t\telse {\n\t\t\tthis.setCell(0,columnIndex,data, create);\n\t\t}\n\t\t\n\t\treturn this;\n\n\t}\n\n\t\n\t\n\tupdateCell(row, column, value, overwrite) {\n\t\tlet rowIndex = this.getRowIndex(row, true);\n\t\tlet columnIndex = this.getColumnIndex(column, true);\n\t\tlet val = this.cell(rowIndex, columnIndex);\n\t\tthis._rows[rowIndex][columnIndex] = val && !overwrite ? val+value : value;\n\t\treturn this;\n\t}\n\t\n\tcell(rowInd, colInd) {\n\t\treturn this._rows[this.getRowIndex(rowInd)][this.getColumnIndex(colInd)];\n\t}\n\n\tsetCell(row, column, value) {\n\t\tthis.updateCell(row,column,value,true);\n\t\treturn this;\n\t}\n\t\t\n\tgetRowIndex(ind, create) {\n\t\tif (typeof ind == \"number\") {\n\t\t\tif (ind < this._rows.length) {\n\t\t\t\treturn ind;\n\t\t\t} else if (create) {\n\t\t\t\tthis._rows[ind] = Array(this.columns());\n\t\t\t\treturn ind;\n\t\t\t}\n\t\t\tthrow new Error(\"The requested row does not exist: \"+ind)\n\t\t} else if (typeof ind == \"string\") {\n\t\t\tlet row = this._rows.findIndex(r => r[this._rowKeyColumnIndex] === ind, this);\n\t\t\tif (row>-1) {return row;}\n\t\t\telse if (create) {\n\t\t\t\tlet arr = Array(this.columns());\n\t\t\t\tarr[this._rowKeyColumnIndex] = ind;\n\t\t\t\tthis.addRow(arr);\n\t\t\t\treturn this.rows();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthrow new Error(\"Unable to find the row named \"+ind);\n\t\t\t}\n\t\t}\n\t\tthrow new Error(\"Please provide a valid row (number or named row)\");\n\t}\n\t\n\tgetColumnIndex(ind, create) {\n\t\tif (typeof ind == \"number\") {\n\t\t\tif (ind < this.columns()) {\n\t\t\t\treturn ind;\n\t\t\t} else if (create) {\n\t\t\t\tthis.addColumn(ind)\n\t\t\t\treturn ind;\n\t\t\t}\n\t\t\tthrow new Error(\"The requested column does not exist: \"+ind)\n\t\t} else if (typeof ind == \"string\") {\n\t\t\tif (ind in this._headers) {\n\t\t\t\treturn this._headers[ind];\n\t\t\t} else if (create) {\n\t\t\t\tthis.addColumn({header: ind});\n\t\t\t\treturn this._headers[ind];\n\t\t\t}\n\t\t\tthrow new Error(\"Unable to find column named \"+ind);\n\t\t}\n\t\tthrow new Error(\"Please provide a valid column (number or named column)\");\n\t}\n\t\n\taddColumn(config, ind) {\n\t\n\t\t// determine col\n\t\tlet col = this.columns(); // default\n\t\tif (config && typeof config == \"string\") {col=config}\n\t\telse if (config && (typeof config == \"object\") && (\"header\" in config)) {col = config.header}\n\t\telse if (ind!==undefined) {col=ind}\n\n\t\t// check if it exists\n\t\tif (col in this._headers) {\n\t\t\tthrow new Error(\"This column exists already: \"+config.header)\n\t\t}\n\t\t\n\t\t// add column\n\t\tlet colIndex = this.columns();\n\t\tthis._headers[col] = colIndex;\n\t\t\n\t\t// determine data\n\t\tlet data = [];\n\t\tif (config && typeof config == \"object\" && \"rows\" in config) {data=config.rows}\n\t\telse if (Array.isArray(config)) {data = config;}\n\t\t\n\t\t// add data to each row\n\t\tthis._rows.forEach((r,i) => r[colIndex] = data[i])\n\t\treturn this;\n\t}\n\t\n\t/**\n\t * This function returns different values depending on the arguments provided.\n\t * When there are no arguments, it returns the number of rows in this table.\n\t * When the first argument is the boolean value `true` all rows are returned.\n\t * When the first argument is a an array then the rows corresponding to the row\n\t * indices or names are returned. When all arguments except are numbers or strings\n\t * then each of those is returned. \n\t */\n\trows(inds, config, ...other) {\n\t\n\t\t// return length\n\t\tif (inds==undefined) {\n\t\t\treturn this._rows.length;\n\t\t}\n\t\t\n\t\tlet rows = [];\n\t\tlet asObj = (config && typeof config == \"object\" && config.asObj) ||\n\t\t\t(other.length>0 && typeof other[other.length-1] == \"object\" && other[other.length-1].asObj);\n\t\t\n\t\t// return all\n\t\tif (typeof inds == \"boolean\" && inds) {\n\t\t\trows = this._rows.map((r,i) => this.row(i, asObj))\n\t\t}\n\t\t\n\t\t// return specified rows\n\t\telse if (Array.isArray(inds)) {\n\t\t\trows = inds.map(ind => this.row(ind));\n\t\t}\n\t\t\n\t\t// return specified rows as varargs\n\t\telse if (typeof inds == \"number\" || typeof inds == \"string\") {\n\t\t\t[inds, config, ...other].every(i => {\n\t\t\t\tif (typeof i == \"number\" || typeof i == \"string\") {\n\t\t\t\t\trows.push(this.row(i, asObj));\n\t\t\t\t\treturn true\n\t\t\t\t} else {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t})\n\t\t\tif (other.length>0) { // when config is in last position\n\t\t\t\tif (typeof other[other.length-1] == \"object\") {\n\t\t\t\t\tconfig = other[other.length-1]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t// zip if requested\n\t\tif (config && typeof config == \"object\" && \"zip\" in config && config.zip) {\n\t\t\tif (rows.length<2) {throw new Error(\"Only one row available, can't zip\")}\n\t\t\treturn Table.zip(rows);\n\t\t}\n\t\telse {\n\t\t\treturn rows;\n\t\t}\n\t}\n\t\n\trow(ind, asObj) {\n\t\tlet row = this._rows[this.getRowIndex(ind)];\n\t\tif (asObj) {\n\t\t\tlet obj = {};\n\t\t\tfor (let key in this._headers) {\n\t\t\t\tobj[key] = row[this._headers[key]]\n\t\t\t}\n\t\t\treturn obj;\n\t\t} else {\n\t\t\treturn row;\n\t\t}\n\t}\n\t\n\t/**\n\t * This function returns different values depending on the arguments provided.\n\t * When there are no arguments, it returns the number of columns in this table.\n\t * When the first argument is the boolean value `true` all columns are returned.\n\t * When the first argument is a number a slice of the columns is returned and if\n\t * the second argument is a number it is treated as the length of the slice to\n\t * return (note that it isn't the `end` index like with Array.slice()).\n\t */\n\tcolumns(inds, config, ...other) {\n\t\n\t\t// return length\n\t\tif (inds==undefined) {\n\t\t\treturn Object.keys(this._headers).length;\n\t\t}\n\t\t\n\t\tlet columns = [];\n\t\tlet asObj = (config && typeof config == \"object\" && config.asObj) ||\n\t\t\t(other.length>0 && typeof other[other.length-1] == \"object\" && other[other.length-1].asObj);\n\t\t\n\t\t// return all columns\n\t\tif (typeof inds == \"boolean\" && inds) {\n\t\t\tfor (let i=0, len=this.columns(); i<len; i++) {\n\t\t\t\tcolumns.push(this.column(i, asObj));\n\t\t\t}\n\t\t}\n\t\t\n\t\t// return specified columns\n\t\telse if (Array.isArray(inds)) {\n\t\t\tinds.forEach(i => columns.push(this.column(i, asObj)), this);\n\t\t}\n\t\t\n\t\telse if (typeof inds == \"number\" || typeof inds == \"string\") {\n\t\t\t[inds, config, ...other].every(i => {\n\t\t\t\tif (typeof i == \"number\" || typeof i == \"string\") {\n\t\t\t\t\tcolumns.push(column(ind, asObj));\n\t\t\t\t\treturn true\n\t\t\t\t} else {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t})\n\t\t\tif (other.length>0) { // when config is in last position\n\t\t\t\tif (typeof other[other.length-1] == \"object\") {\n\t\t\t\t\tconfig = other[other.length-1]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (config && typeof config == \"object\" && \"zip\" in config && config.zip) {\n\t\t\tif (columns.length<2) {throw new Error(\"Only one column available, can't zip\")}\n\t\t\treturn Table.zip(columns);\n\t\t}\n\t\telse {\n\t\t\treturn columns;\n\t\t}\n\t}\n\t\n\tcolumn(ind, asObj) {\n\t\tlet column = this.getColumnIndex(ind);\n\t\tlet data = this._rows.forEach(r => r[column]);\n\t\tif (asObj) {\n\t\t\tlet obj = {};\n\t\t\tthis._rows.forEach(r => {\n\t\t\t\tobj[r[this._rowKeyColumnIndex]] = r[column];\n\t\t\t})\n\t\t\treturn obj;\n\t\t} else {\n\t\t\treturn this._rows.map(r => r[column]);\n\t\t}\n\t}\n\t\n\theader(ind) {\n\t\tlet keys = Object.keys(this._headers);\n\t\tlet i = this.getColumnIndex(ind);\n\t\treturn keys[keys.findIndex(k => i==this._headers[k])]\n\t}\n\t\n\theaders(inds, ...other) {\n\t\t\n\t\t// return length\n\t\tif (inds==undefined) {\n\t\t\treturn this._headers.length;\n\t\t}\n\n\t\tlet headers = [];\n\t\t\n\t\t// return all\n\t\tif (typeof inds == \"boolean\" && inds) {\n\t\t\tinds = Array(Object.keys(this._headers).length).fill().map((_,i) => i);\n\t\t}\n\t\t\n\t\t// return specified rows\n\t\tif (Array.isArray(inds)) {\n\t\t\treturn inds.map(i => this.header(i));\n\t\t}\n\t\t\n\t\t// return specified rows as varargs\n\t\telse if (typeof inds == \"number\" || typeof inds == \"string\") {\n\t\t\treturn [inds, ...other].map(i => this.header(i));\n\t\t}\n\t}\n\n\thasColumn(ind) {\n\t\treturn ind in this._headers;\n\t}\n\t\n\tforEach(fn) {\n\t\tthis._rows.forEach((r,i) => fn(r,i));\n\t}\n\t\n\trowMin(ind) {\n\t\treturn Math.min.apply(null, this.row(ind));\n\t}\n\t\n\trowMax(ind) {\n\t\treturn Math.max.apply(null, this.row(ind));\n\t}\n\t\n\tcolumnMin(ind) {\n\t\treturn Math.min.apply(null, this.column(ind));\n\t}\n\t\n\tcolumnMax(ind) {\n\t\treturn Math.max.apply(null, this.column(ind));\n\t}\n\t\n\trowSum(ind) {\n\t\treturn Table.sum(this.row(ind));\n\t}\n\t\n\tcolumnSum(ind) {\n\t\treturn Table.sum(this.column(ind));\n\t}\n\n\trowMean(ind) {\n\t\treturn Table.mean(this.row(ind));\n\t}\n\t\n\tcolumnMean(ind) {\n\t\treturn Table.mean(this.column(ind));\n\t}\n\t\n\trowCounts(ind) {\n\t\treturn Table.counts(this.row(ind));\n\t}\n\t\n\tcolumnCounts(ind) {\n\t\treturn Table.counts(this.column(ind));\n\t}\n\t\n\trowRollingMean(ind, neighbors, overwrite) {\n\t\tlet means = Table.rollingMean(this.row(ind), neighbors);\n\t\tif (overwrite) {\n\t\t\tthis.setRow(ind, means);\n\t\t}\n\t\treturn means;\n\t}\n\t\n\tcolumnRollingMean(ind, neighbors, overwrite) {\n\t\tlet means = Table.rollingMean(this.column(ind), neighbors);\n\t\tif (overwrite) {\n\t\t\tthis.setColumn(ind, means);\n\t\t}\n\t\treturn means;\n\t}\n\t\n\trowVariance(ind) {\n\t\treturn Table.variance(this.row(ind));\n\t}\n\t\n\tcolumnVariance(ind) {\n\t\treturn Table.variance(this.column(ind));\n\t}\n\t\n\trowStandardDeviation(ind) {\n\t\treturn Table.standardDeviation(this.row(ind));\n\t}\n\t\n\tcolumnStandardDeviation(ind) {\n\t\treturn Table.standardDeviation(this.column(ind));\n\t}\n\t\n\trowZScores(ind) {\n\t\treturn Table.zScores(this.row(ind));\n\t}\n\t\n\tcolumnZScores(ind) {\n\t\treturn Table.zScores(this.column(ind));\n\t}\n\t\n\trowSort(inds, config) {\n\n\t\t// no inds, use all columns\n\t\tif (inds===undefined) {\n\t\t\tinds = Array(this.columns()).fill().map((_,i) => i)\n\t\t}\n\n\t\t// wrap a single index as array\n\t\tif (typeof inds == \"string\" || typeof inds == \"number\") {\n\t\t\tinds = [inds];\n\t\t}\n\n\t\tif (Array.isArray(inds)) {\n\t\t\treturn this.rowSort((a,b) => {\n\t\t\t\tlet ind;\n\t\t\t\tfor (let i=0, len=inds.length; i<len; i++) {\n\t\t\t\t\tind = this.getColumnIndex(inds[i]);\n\t\t\t\t\tif (a!=b) {\n\t\t\t\t\t\tif (typeof a[ind] == \"string\" && typeof b[ind] == \"string\") {\n\t\t\t\t\t\t\treturn a[ind].localeCompare(b[ind]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn a[ind]-b[ind];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}, config)\n\t\t}\n\n\t\tif (typeof inds == \"function\") {\n\t\t\tthis._rows.sort((a,b) => {\n\t\t\t\tif (config && \"asObject\" in config && config.asObject) {\n\t\t\t\t\tlet c = {};\n\t\t\t\t\tfor (let k in this._headers) {\n\t\t\t\t\t\tc[k] = a[this._headers[k]]\n\t\t\t\t\t}\n\t\t\t\t\tlet d = {};\n\t\t\t\t\tfor (let k in this._headers) {\n\t\t\t\t\t\td[k] = b[this._headers[k]]\n\t\t\t\t\t}\n\t\t\t\t\treturn inds.apply(this, [c,d]);\n\t\t\t\t} else {\n\t\t\t\t\treturn inds.apply(this, [a,b]);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (config && \"reverse\" in config && config.reverse) {\n\t\t\t\tthis._rows.reverse(); // in place\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn this;\n\t}\n\t\n\tcolumnSort(inds, config) {\n\t\t\n\t\t// no inds, use all columns\n\t\tif (inds===undefined) {\n\t\t\tinds = Array(this.columns()).fill().map((_,i) => i);\n\t\t}\n\n\t\t// wrap a single index as array\n\t\tif (typeof inds == \"string\" || typeof inds == \"number\") {\n\t\t\tinds = [inds];\n\t\t}\n\t\t\n\t\tif (Array.isArray(inds)) {\n\t\t\t\n\t\t\t// convert to column names\n\t\t\tlet headers = inds.map(ind => this.header(ind));\n\t\t\t\n\t\t\t// make sure we have all columns\n\t\t\tObject.keys(this._headers).forEach(h => {\n\t\t\t\tif (!headers.includes(h)) {headers.push(h)}\n\t\t\t});\n\t\t\t\n\t\t\t// sort names alphabetically\n\t\t\theaders.sort((a,b) => a.localeCompare(b))\n\t\t\t\n\t\t\t// reorder by columns\n\t\t\tthis._rows = this._rows.map((_,i) => headers.map(h => this.cell(i,h)));\n\t\t\tthis._headers = {};\n\t\t\theaders.forEach((h,i) => this._headers[h]=i)\n\t\t\t\n\t\t}\n\t\t\n\t\tif (typeof inds == \"function\") {\n\t\t\tlet headers = Object.keys(this._headers);\n\t\t\tif (config && \"asObject\" in headers && headers.asObject) {\n\t\t\t\theaders = headers.map((h,i) => {\n\t\t\t\t\treturn {header: h, data: this._rows.map((r,j) => this.cell(i,j))}\n\t\t\t\t})\n\t\t\t}\n\t\t\theaders.sort((a,b) => {\n\t\t\t\treturn inds.apply(this, [a,b]);\n\t\t\t})\n\t\t\theaders = headers.map(h => typeof h == \"object\" ? h.header : h); // convert back to string\n\t\t\t\n\t\t\t// make sure we have all keys\n\t\t\tObject.keys(this._headers).forEach(k => {\n\t\t\t\tif (headers.indexOf(k)==-1) {headers.push(k)}\n\t\t\t})\n\t\t\t\n\t\t\tthis._rows = this._rows.map((_,i) => headers.map(h => this.cell(i,h)));\n\t\t\tthis._headers = {};\n\t\t\theaders.forEach((h,i) => this._headers[h]=i)\n\t\t}\n\t\t\n\t}\n\t\n\tchart(target, config) {\n\t\tChart.chart(target, config);\n\t}\n\t\n\ttoCsv(config) {\n\t\tconst cell = function(c) {\n\t\t\tlet quote = /\"/g;\n\t\t\treturn typeof c == \"string\" && (c.indexOf(\",\")>-1 || c.indexOf('\"')>-1) ? '\"'+c.replace(quote,'\\\"')+'\"' : c;\n\t\t}\n\t\treturn (config && \"noHeaders\" in config && config.noHeaders ? \"\" : this.headers(true).map(h => cell(h)).join(\",\") + \"\\n\") +\n\t\t\tthis._rows.map(row => row.map(c => cell(c)).join(\",\")).join(\"\\n\")\n\t}\n\t\n\ttoTsv(config) {\n\t\treturn config && \"noHeaders\" in config && config.noHeaders ? \"\" : this.headers(true).join(\"\\t\") + \"\\n\" +\n\t\t\tthis._rows.map(row => row.join(\"\\t\")).join(\"\\n\");\n\t}\n\t\n\thtml(target, config) {\n\t\tlet html = this.toString();\n\t\tif (typeof target == \"function\") {\n\t\t\ttarget(html)\n\t\t} else {\n\t\t\tif (typeof target == \"string\") {\n\t\t\t\ttarget = document.querySelector(target);\n\t\t\t\tif (!target) {\n\t\t\t\t\tthrow \"Unable to find specified target: \"+target;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof target == \"object\" && \"innerHTML\" in target) {\n\t\t\t\ttarget.innerHTML = html;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\t\n\ttoString(config) {\n\t\treturn \"<table class='voyantTable'>\" +\n\t\t\t((config && \"caption\" in config && typeof config.caption == \"string\") ?\n\t\t\t\t\t\"<caption>\"+config.caption+\"</caption>\" : \"\") +\n\t\t\t((config && \"noHeaders\" in config && config.noHeaders) ? \"\" : (\"<thead><tr>\"+this.headers(true).map(c => \"<th>\"+c+\"</th>\").join(\"\")+\"</tr></thead>\"))+\n\t\t\t\"<tbody>\"+\n\t\t\tthis._rows.map(row => \"<tr>\"+row.map(c => \"<td>\"+(typeof c === \"number\" ? c.toLocaleString() : c)+\"</td>\").join(\"\")+\"</tr>\").join(\"\") +\n\t\t\t\"</tbody></table>\";\n\t}\n\t\n\tchart(config = {}) {\n\t\t\n\t\tlet target = config.target;\n\t\tif (target === undefined) {\n\t\t\tif (Spyral && Spyral.Notebook) {\n\t\t\t\ttarget = Spyral.Notebook.getTarget().results.el.dom;\n\t\t\t} else {\n\t\t\t\ttarget = document.createElement(\"div\");\n\t\t\t\tdocument.body.appendChild(target);\n\t\t\t}\n\t\t}\n\n\t\tconfig.chart = config.chart || {};\n\t\t\n\t\tlet columnsCount = this.columns();\n\t\tlet rowsCount = this.rows();\n\t\tlet headers = this.headers(config.columns ? config.columns : true);\n\t\tlet isHeadersCategories = headers.every(h => isNaN(h));\n\n\t\tif (isHeadersCategories) {\n\t\t\tChart.setDefaultChartType(config, \"column\");\n\t\t}\n\n\t\t// set categories if not set\n\t\tconfig.xAxis = config.xAxis || {};\n\t\tconfig.xAxis.categories = config.xAxis.categories || headers;\n\t\t\n\t\t// start filling in series\n\t\tconfig.series = config.series || [];\n\t\t\n\t\t// one row, so let's take series from rows\n\t\tif (rowsCount==1) {\n\t\t\tconfig.seriesFrom = config.seriesFrom || \"rows\";\n\t\t}\n\t\t\n\t\tif (config.seriesFrom === \"rows\") {\n\t\t\tthis.rows(config.rows ? config.rows : true).forEach((row, i) => {\n\t\t\t\tconfig.series[i] = config.series[i] || {};\n\t\t\t\tconfig.series[i].data = headers.map(h => this.cell(i, h));\n\t\t\t})\n\t\t} else if (config.seriesFrom === \"columns\") {\n\t\t\tthis.columns(config.columns ? config.columns : true).forEach((col, i) => {\n\t\t\t\tconfig.series[i] = config.series[i] || {};\n\t\t\t\tconfig.series[i].data = [];\n\t\t\t\tfor (let r = 0; r < rowsCount; r++) {\n\t\t\t\t\tconfig.series[i].data.push(this.cell(r, i));\n\t\t\t\t}\n\t\t\t})\n\t\t} else {\n\t\t\t\n\t\t}\n\t\t\n\t\treturn Chart.chart(target, config);\n\t}\n\t\n\tstatic create(data, config) {\n\t\treturn new Table(data, config);\n\t}\n\t\n\tstatic fetch(input, api, config) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\twindow.fetch(input, api).then(response => {\n\t\t\t\tif (!response.ok) {throw new Error(response.status + \" \" + response.statusText);}\n\t\t\t\tresponse.text().then(text => {\n\t\t\t\t\tresolve(Table.create(text, config || api))\n\t\t\t\t})\n\t\t\t})\n\t\t})\n\t}\n\n\tstatic counts(data) {\n\t\tlet vals = {};\n\t\tdata.forEach(v => v in vals ? vals[v]++ : vals[v]=1);\n\t\treturn vals;\n\t}\n\t\n\tstatic cmp(a, b) {\n\t\treturn typeof a == \"string\" && typeof b == \"string\" ? a.localeCompare(b) : a-b;\n\t}\n\n\tstatic sum(data) {\n\t\treturn data.reduce((a,b) => a+b, 0);\n\t}\n\t\n\tstatic mean(data) {\n\t\treturn Table.sum(data) / data.length;\n\t}\n\t\n\tstatic rollingMean(data, neighbors) {\n\t\t// https://stackoverflow.com/questions/41386083/plot-rolling-moving-average-in-d3-js-v4/41388581#41387286\n\t\treturn data.map((val, idx, arr) => {\n\t\t\tlet start = Math.max(0, idx - neighbors), end = idx + neighbors\n\t\t\tlet subset = arr.slice(start, end + 1)\n\t\t\tlet sum = subset.reduce((a,b) => a + b)\n\t\t\treturn sum / subset.length\n\t\t});\n\t}\n\t\n\tstatic variance(data) {\n\t\tlet m = Table.mean(data);\n\t\treturn Table.mean(data.map(num => Math.pow(num-m, 2)));\n\t}\n\t\n\tstatic standardDeviation(data) {\n\t\treturn Math.sqrt(Table.variance(data));\n\t}\n\t\n\tstatic zScores(data) {\n\t\tlet m = Table.mean(data);\n\t\tlet s = Table.standardDeviation(data);\n\t\treturn data.map(num => (num-m) / s);\n\t}\n\t\n\tstatic zip(...data) {\n\t\n\t\t// we have a single nested array, so let's recall with flattened arguments\n\t\tif (data.length==1 && Array.isArray(data) && data.every(d => Array.isArray(d))) {\n\t\t\treturn Table.zip.apply(null, ...data);\n\t\t}\n\t\t\n\t\t// allow arrays to be of different lengths\n\t\tlet len = Math.max.apply(null, data.map(d => d.length));\n\t\treturn new Array(len).fill().map((_,i) => data.map(d => d[i]));\n\t}\n}\n\n// this seems like a good balance between a built-in flexible parser and a heavier external parser\n// https://lowrey.me/parsing-a-csv-file-in-es6-javascript/\nconst regex = /(?!\\s*$)\\s*(?:'([^'\\\\]*(?:\\\\[\\S\\s][^'\\\\]*)*)'|\"([^\"\\\\]*(?:\\\\[\\S\\s][^\"\\\\]*)*)\"|([^,'\"\\s\\\\]*(?:\\s+[^,'\"\\s\\\\]+)*))\\s*(?:,|$)/g;\nfunction parseCsvLine(line) {\n\tlet arr = [];\n\tline.replace(regex, (m0, m1, m2, m3) => {\n\t\tif (m1 !== undefined) {\n\t\t\tarr.push(m1.replace(/\\\\'/g, \"'\"));\n\t\t} else if (m2 !== undefined) {\n\t\t\tarr.push(m2.replace(/\\\\\"/g, \"\\\"\"));\n\t\t} else if (m3 !== undefined) {\n\t\t\tarr.push(m3);\n\t\t}\n\t\treturn \"\";\n\t});\n\tif (/,\\s*$/.test(line)) {arr.push(\"\");}\n\treturn arr;\n\t\n}\n\nexport function create(data, config, ...other) {\n\treturn new Table(data, config, ...other);\n}\n\nexport function fetch(input, api, config) {\n\treturn Table.fetch(input, api, config);\n}\n","export class Notebook {\n\tstatic getPreviousBlock() {\n\t\treturn Spyral.Notebook.getBlock(-1);\n\t}\n\tstatic getNextBlock() {\n\t\treturn Spyral.Notebook.getBlock(1);\n\t}\n\tstatic getBlock() {\n\t\tif (Voyant && Voyant.notebook) {\n\t\t\treturn Voyant.notebook.Notebook.currentNotebook.getBlock.apply(Voyant.notebook.Notebook.currentNotebook, arguments)\n\t\t}\n\t}\n\tstatic show(contents, config) {\n\t\tvar contents = Spyral.Util.toString(contents, config);\n\t\tif (contents instanceof Promise) {\n\t\t\tcontents.then(c => Voyant.notebook.util.Show.show(c))\n\t\t} else {\n\t\t\tVoyant.notebook.util.Show.show(contents);\n\t\t}\n\t}\n\tstatic getTarget() {\n\t\tif (Voyant && Voyant.notebook && Voyant.notebook.Notebook.currentBlock) {\n\t\t\treturn Voyant.notebook.Notebook.currentBlock;\n\t\t} else {\n\t\t\ttarget = document.createElement(\"div\");\n\t\t\tdocument.body.appendChild(target);\n\t\t\treturn target;\n\t\t}\n\t}\n}\n","export class Util {\n\tstatic id(len) {\n\t\tlen = len || 8;\n\t\t// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript\n\t\treturn Math.random().toString(36).substring(2, 2+len) + Math.random().toString(36).substring(2, 2+len)\n\t}\n\tstatic toString(contents, config) {\n\t\tif (contents.constructor === Array || contents.constructor===Object) {\n\t\t\tcontents = JSON.stringify(contents);\n\t\t\tif (contents.length>500) {\n\t\t\t\tcontents = '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z\"/><path d=\"M0 0h24v24H0z\" fill=\"none\"/></svg>'+contents.substring(0,500)+\" <a href=''>+</a><div style='display: none'>\"+contents.substring(501)+\"</div>\";\n\t\t\t}\n\t\t}\n\t\treturn contents.toString();\n\t}\n\tstatic more(before, more, after) {\n\t\treturn before + '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z\"/><path d=\"M0 0h24v24H0z\" fill=\"none\"/></svg>'+contents.substring(0,500)+\" <a href=''>+</a><div style='display: none'>\"+contents.substring(501)+\"</div>\";\n\n\t}\n}\n","export class Metadata {\n\tconstructor(config) {\n\t\t['title', 'author', 'description', 'keywords', 'modified', 'created', 'language', 'license'].forEach(key => {\n\t\t\tthis[key] = undefined;\n\t\t})\n\t\tthis.version = \"0.1\"; // may be changed by config\n\t\tif (config instanceof HTMLDocument) {\n\t\t\tconfig.querySelectorAll(\"meta\").forEach(function(meta) {\n\t\t\t\tvar name =  meta.getAttribute(\"name\");\n\t\t\t\tif (name && this.hasOwnProperty(name)) {\n\t\t\t\t\tvar content = meta.getAttribute(\"content\");\n\t\t\t\t\tif (content) {\n\t\t\t\t\t\tthis[name] = content;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, this);\n\t\t} else {\n\t\t\tthis.set(config);\n\t\t}\n\t\tif (!this.created) {this.setDateNow(\"created\")}\n\t}\n\tset(config) {\n\t\tfor (var key in config) {\n\t\t\tif (this.hasOwnProperty(key)) {\n\t\t\t\tthis[key] = config[key];\n\t\t\t}\n\t\t}\n\t}\n\tsetDateNow(field) {\n\t\tthis[field] = new Date().toISOString();\n\t}\n\tshortDate(field) {\n\t\treturn this[field] ? (new Date(Date.parse(this[field])).toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' })) : undefined;\n\t}\n\tgetHeaders() {\n\t\tvar quotes = /\"/g, newlines = /(\\r\\n|\\r|\\n)/g, tags = /<\\/?\\w+.*?>/g,\n\t\t\theaders = \"<title>\"+(this.title || \"\").replace(tags,\"\")+\"</title>\\n\"\n\t\tfor (var key in this) {\n\t\t\tif (this[key]) {\n\t\t\t\theaders+='<meta name=\"'+key+'\" content=\"'+this[key].replace(quotes, \"&quot;\").replace(newlines, \" \")+'\">';\n\t\t\t}\n\t\t}\n\t\treturn headers;\n\t}\n}\n"],"names":["Loader","baseUrl","config","params","url","URL","trombone","all","key","undefined","searchParams","Object","keys","map","encodeURIComponent","join","opt","length","set","method","headers","body","fetch","then","response","ok","json","text","Voyant","util","DetailedError","msg","error","split","shift","details","showMsg","alert","window","console","Error","urlToFetch","err","DOMParser","parseFromString","load","Corpus","create","id","api","corpus","metadata","summary","titles","texts","terms","tokens","words","contexts","collocates","phrases","correlations","tool","target","htmltool","html","setBaseUrl","isDocumentsMode","mode","documents","corpusid","me","Promise","resolve","data","documentsMetadata","alias","documentsCount","toLocaleString","lexicalTokensCount","lexicalTypesCount","doc","title","documentTerms","corpusTerms","documentTokens","limit","noOthers","query","warn","documentContexts","corpusCollocates","documentNgrams","ngrams","corpusNgrams","termCorrelations","reject","out","defaultAttributes","width","height","style","attr","val","voyantUrl","append","forEach","document","querySelector","innerHTML","promise","test","input","name","args","arguments","apply","assign","chart","subtitle","credits","xAxis","yAxis","Highcharts","setDefaultChartType","type","Table","other","_rows","_headers","_rowKeyColumnIndex","Array","isArray","rows","concat","filter","v","from","every","a","indexOf","String","format","line","i","trim","values","parseCsvLine","isNaN","setHeaders","push","Number","hasHeaders","count","freqs","counts","orientation","item","addRow","rowSort","b","cmp","columnSort","cell","addRows","rowKeyColumn","columns","rowKeyColum","h","addColumn","row","setRow","ind","rowIndex","getRowIndex","d","setCell","column","hasColumn","columnIndex","getColumnIndex","value","overwrite","rowInd","colInd","updateCell","findIndex","r","arr","header","col","colIndex","inds","asObj","zip","obj","len","k","fill","_","fn","Math","min","max","sum","mean","neighbors","means","rollingMean","setColumn","variance","standardDeviation","zScores","localeCompare","sort","asObject","c","reverse","includes","j","Chart","quote","replace","noHeaders","toString","caption","Spyral","Notebook","getTarget","results","el","dom","createElement","appendChild","columnsCount","rowsCount","isHeadersCategories","categories","series","seriesFrom","status","statusText","vals","reduce","idx","start","end","subset","slice","m","num","pow","sqrt","s","regex","m0","m1","m2","m3","getBlock","notebook","currentNotebook","contents","Util","Show","show","currentBlock","random","substring","constructor","JSON","stringify","before","more","after","Metadata","version","HTMLDocument","querySelectorAll","meta","getAttribute","hasOwnProperty","content","created","setDateNow","field","Date","toISOString","parse","toLocaleDateString","year","month","day","quotes","newlines","tags"],"mappings":"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"}